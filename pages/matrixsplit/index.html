<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<title>
Splitting curves using matrices
</title>
<base href='..'>
</head>
<body>
<div data-reactid=".1yf285yww00" data-react-checksum="1705938772"><div class="ribbon" data-reactid=".1yf285yww00.0"><img src="images/ribbon.png" alt="This page on GitHub" usemap="#githubmap" width="200px" height="149px" data-reactid=".1yf285yww00.0.0"/><map name="githubmap" data-reactid=".1yf285yww00.0.1"><area shape="poly" coords="30,0, 200,0, 200,114" href="http://github.com/pomax/BezierInfo-2" alt="This page on GitHub" data-reactid=".1yf285yww00.0.1.0"/></map></div><header data-reactid=".1yf285yww00.1"><h1 data-reactid=".1yf285yww00.1.0">A Primer on Bézier Curves</h1><h2 data-reactid=".1yf285yww00.1.1">A free, online book for when you really need to know how to do Bézier things.</h2></header><div data-reactid=".1yf285yww00.2"><table class="relatives before" data-reactid=".1yf285yww00.2.0"><tbody data-reactid=".1yf285yww00.2.0.0"><tr data-reactid=".1yf285yww00.2.0.0.0"><td data-reactid=".1yf285yww00.2.0.0.0.0"><a class="prev" href="splitting" data-reactid=".1yf285yww00.2.0.0.0.0.0">8. Splitting curves</a></td><td class="toc" data-reactid=".1yf285yww00.2.0.0.0.1"><a class="" href="/" data-reactid=".1yf285yww00.2.0.0.0.1.0">ToC</a></td><td data-reactid=".1yf285yww00.2.0.0.0.2"><a class="next" href="reordering" data-reactid=".1yf285yww00.2.0.0.0.2.0">10. Lowering and elevating curve order</a></td></tr></tbody></table><section data-reactid=".1yf285yww00.2.$matrixsplit"><h2 data-num="9" data-reactid=".1yf285yww00.2.$matrixsplit.0"><a href="#matrixsplit" data-reactid=".1yf285yww00.2.$matrixsplit.0.0">Splitting curves using matrices</a></h2><p data-reactid=".1yf285yww00.2.$matrixsplit.1"><span data-reactid=".1yf285yww00.2.$matrixsplit.1.0">Another way to split curves is to exploit the matrix representation of a Bézier curve. In </span><a href="#matrix" data-reactid=".1yf285yww00.2.$matrixsplit.1.1">the section on matrices</a><span data-reactid=".1yf285yww00.2.$matrixsplit.1.2"> we saw that we can represent curves as matrix multiplications. Specifically, we saw these two forms for the quadratic, and cubic curves, respectively (using the reversed Bézier coefficients vector for legibility):</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.2"><img class="LaTeX SVG" src="images/latex/e56e78e406d625c2a5ec584216f79a5fee00d8ea.svg" style="width:19.65015rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.2.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.3">and</p><p data-reactid=".1yf285yww00.2.$matrixsplit.4"><img class="LaTeX SVG" src="images/latex/01ea4f74c4785a19bedf18034b51510c5ce2ad8f.svg" style="width:23.925150000000002rem;height:5.47515rem;" data-reactid=".1yf285yww00.2.$matrixsplit.4.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.5"><span data-reactid=".1yf285yww00.2.$matrixsplit.5.0">Let&#x27;s say we want to split the curve at some point </span><em data-reactid=".1yf285yww00.2.$matrixsplit.5.1">t = z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.5.2">, forming two new (obviously smaller) Bézier curves. To find the coordinates for these two Bézier curves, we can use the matrix representation and some linear algebra. First, we split out the the actual &quot;point on the curve&quot; information as a new matrix multiplication:</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.6"><img class="LaTeX SVG" src="images/latex/d6fa091a86782480968c232ef86513c578030004.svg" style="width:48.07485rem;height:4.05rem;" data-reactid=".1yf285yww00.2.$matrixsplit.6.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.7">and</p><p data-reactid=".1yf285yww00.2.$matrixsplit.8"><img class="LaTeX SVG" src="images/latex/d487e1e0181420995be49b25bc6595c9d0360435.svg" style="width:60.82515rem;height:5.54985rem;" data-reactid=".1yf285yww00.2.$matrixsplit.8.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.9"><span data-reactid=".1yf285yww00.2.$matrixsplit.9.0">If we could compact these matrices back to a form </span><strong data-reactid=".1yf285yww00.2.$matrixsplit.9.1">[t values] · [bezier matrix] · [column matrix]</strong><span data-reactid=".1yf285yww00.2.$matrixsplit.9.2">, with the first two staying the same, then that column matrix on the right would be the coordinates of a new Bézier curve that describes the first segment, from </span><em data-reactid=".1yf285yww00.2.$matrixsplit.9.3">t = 0</em><span data-reactid=".1yf285yww00.2.$matrixsplit.9.4"> to </span><em data-reactid=".1yf285yww00.2.$matrixsplit.9.5">t = z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.9.6">. As it turns out, we can do this quite easily, by exploiting some simple rules of linear algebra (and if you don&#x27;t care about the derivations, just skip to the end of the box for the results!).</span></p><div class="note" data-reactid=".1yf285yww00.2.$matrixsplit.a"><h2 data-reactid=".1yf285yww00.2.$matrixsplit.a.0">Deriving new hull coordinates</h2><p data-reactid=".1yf285yww00.2.$matrixsplit.a.1">Deriving the two segments upon splitting a curve takes a few steps, and the higher the curve order, the more work it is, so let&#x27;s look at the quadratic curve first:</p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.2"><img class="LaTeX SVG" src="images/latex/d4b8355c3f1f80aacfc2766423a30151c5180a02.svg" style="width:26.24985rem;height:4.05rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.2.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.3"><img class="LaTeX SVG" src="images/latex/fe5f623585a9bbb836f54164aecaadd3fc4ec953.svg" style="width:17.62515rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.3.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.4"><img class="LaTeX SVG" src="images/latex/1eb9833685c9189c64d9cbdfdbb24a94e70e493f.svg" style="width:17.69985rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.4.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.5"><img class="LaTeX SVG" src="images/latex/bc85dbb857222546bd30ea559a452fe9f36c8090.svg" style="width:17.69985rem;height:4.05rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.5.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.6"><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.0">We do this, because [</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.1"><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.1.0">M · M</span><sup data-reactid=".1yf285yww00.2.$matrixsplit.a.6.1.1">-1</sup></em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.2">] is the identity matrix (a bit like multiplying something by x/x in calculus. It doesn&#x27;t do anything to the function, but it does allow you to rewrite it to something that may be easier to work with, or can be broken up differently). Adding that as matrix multiplication has no effect on the total formula, but it does allow us to change the matrix sequence [</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.3">something · M</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.4">] to a sequence [</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.5">M · something</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.6">], and that makes a world of difference: if we know what [</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.7"><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.7.0">M</span><sup data-reactid=".1yf285yww00.2.$matrixsplit.a.6.7.1">-1</sup><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.7.2"> · Z · M</span></em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.8">] is, we can apply that to our coordinates, and be left with a proper matrix representation of a quadratic Bézier curve (which is [</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.9">T · M · P</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.a">]), with a new set of coordinates that represent the curve from</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.b">t = 0</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.c"> to </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.6.d">t = z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.6.e">. So let&#x27;s get computing:</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.7"><img class="LaTeX SVG" src="images/latex/1dbabc115128a85389cbbcc75fbced48e5a2ca25.svg" style="width:45.9rem;height:4.35015rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.7.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.8">Excellent! Now we can form our new quadratic curve:</p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.9"><img class="LaTeX SVG" src="images/latex/2972cd74dab6560ea68189c2e53f247287cbefae.svg" style="width:30.45015rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.9.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.a"><img class="LaTeX SVG" src="images/latex/39b64e07c41ef6d734064f017036f6391321e924.svg" style="width:35.17515rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.a.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.b"><img class="LaTeX SVG" src="images/latex/d615960f862664749c54858520c364efeb4a4c5a.svg" style="width:34.79985rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.b.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.c"><strong data-reactid=".1yf285yww00.2.$matrixsplit.a.c.0"><em data-reactid=".1yf285yww00.2.$matrixsplit.a.c.0.0">Brilliant</em></strong><span data-reactid=".1yf285yww00.2.$matrixsplit.a.c.1">: if we want a subcurve from </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.c.2">t = 0</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.c.3">to </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.c.4">t = z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.c.5">, we can keep the first coordinate the same (which makes sense), our control point becomes a z-ratio mixture of the original control point and the start point, and the new end point is a mixture that looks oddly similar to a bernstein polynomial of degree two, except it uses (z-1) rather than (1-z)... These new coordinates are actually really easy to compute directly!</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.d"><span data-reactid=".1yf285yww00.2.$matrixsplit.a.d.0">Of course, that&#x27;s only one of the two curves. Getting the section from </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.d.1">t = z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.d.2">to </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.d.3">t = 1</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.d.4"> requires doing this again. We first observe what what we just did is actually evaluate the general interval [0,</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.d.5">z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.d.6">], which we wrote down simplified becuase of that zero, but we actually evaluated this:</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.e"><img class="LaTeX SVG" src="images/latex/a51e64df3cb31acf32d0ad5814c8c6cff41ae611.svg" style="width:27.45rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.e.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.f"><img class="LaTeX SVG" src="images/latex/0b50cdfed6656e681d5885a14a3af3e67efa4ccb.svg" style="width:23.99985rem;height:4.05rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.f.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.g"><span data-reactid=".1yf285yww00.2.$matrixsplit.a.g.0">If we want the interval [</span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.g.1">z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.g.2">,1], we will be evaluating this instead:</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.h"><img class="LaTeX SVG" src="images/latex/eca8cfda9b7a3f0819ec38acc53f95af67bb26bb.svg" style="width:32.625rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.h.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.i"><img class="LaTeX SVG" src="images/latex/e8c983a3efd47356c971fe46add4d0cdf103cced.svg" style="width:30.45015rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.i.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.j"><span data-reactid=".1yf285yww00.2.$matrixsplit.a.j.0">We&#x27;re going to do the same trick, to turn </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.j.1">[something · M]</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.j.2"> into </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.j.3">[M · something]</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.j.4">:</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.k"><img class="LaTeX SVG" src="images/latex/a28b6dcc1335de19a065b6a04d8bb45d86122bb7.svg" style="width:52.72515rem;height:4.35015rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.k.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.l">So, our final second curve looks like:</p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.m"><img class="LaTeX SVG" src="images/latex/5851c9191acb59456e3706a8f6f1a0f85e691eda.svg" style="width:30.74985rem;height:3.97485rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.m.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.n"><img class="LaTeX SVG" src="images/latex/0333e63f50b3d43067dc299280f70e9eb98711bb.svg" style="width:34.875rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.n.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.o"><img class="LaTeX SVG" src="images/latex/00a133860115d7a4db4ddf62781b5ae2bffef088.svg" style="width:34.79985rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.a.o.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.a.p"><strong data-reactid=".1yf285yww00.2.$matrixsplit.a.p.0"><em data-reactid=".1yf285yww00.2.$matrixsplit.a.p.0.0">Nice</em></strong><span data-reactid=".1yf285yww00.2.$matrixsplit.a.p.1">: we see the same as before; can keep the last coordinate the same (which makes sense), our control point becomes a z-ratio mixture of the original control point and the end point, and the new start point is a mixture that looks oddly similar to a bernstein polynomial of degree two, except it uses (z-1) rather than (1-z). These new coordinates are </span><em data-reactid=".1yf285yww00.2.$matrixsplit.a.p.2">also</em><span data-reactid=".1yf285yww00.2.$matrixsplit.a.p.3">really easy to compute directly!</span></p></div><p data-reactid=".1yf285yww00.2.$matrixsplit.b"><span data-reactid=".1yf285yww00.2.$matrixsplit.b.0">So, using linear algebra rather than de Casteljau&#x27;s algorithm, we have determined that for any quadratic curve split at some value </span><em data-reactid=".1yf285yww00.2.$matrixsplit.b.1">t = z</em><span data-reactid=".1yf285yww00.2.$matrixsplit.b.2">, we get two subcurves that are described as Bézier curves with simple-to-derive coordinates.</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.c"><img class="LaTeX SVG" src="images/latex/5769f44aea3344c32c497a3a77d236f524222b95.svg" style="width:40.57515rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.c.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.d">and</p><p data-reactid=".1yf285yww00.2.$matrixsplit.e"><img class="LaTeX SVG" src="images/latex/1fdde935dc357642358bdf5e632d6539c9d4debd.svg" style="width:40.275rem;height:4.1998500000000005rem;" data-reactid=".1yf285yww00.2.$matrixsplit.e.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.f">We can do the same for cubic curves. However, I&#x27;ll spare you the actual derivation (don&#x27;t let that stop you from writing that out yourself, though) and simply show you the resulting new coordinate sets:</p><p data-reactid=".1yf285yww00.2.$matrixsplit.g"><img class="LaTeX SVG" src="images/latex/44db09290062827525a9b23cbaf91e65063d86d7.svg" style="width:58.87485rem;height:5.70015rem;" data-reactid=".1yf285yww00.2.$matrixsplit.g.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.h">and</p><p data-reactid=".1yf285yww00.2.$matrixsplit.i"><img class="LaTeX SVG" src="images/latex/d6b1abe72bac1b55d184f2c4254769404371d06f.svg" style="width:59.025150000000004rem;height:5.70015rem;" data-reactid=".1yf285yww00.2.$matrixsplit.i.0"/></p><p data-reactid=".1yf285yww00.2.$matrixsplit.j"><span data-reactid=".1yf285yww00.2.$matrixsplit.j.0">So, looking at our matrices, did we really need to compute the second segment matrix? No, we didn&#x27;t. Actually having one segment&#x27;s matrix means we implicitly have the other: push the values of each row in the matrix </span><strong data-reactid=".1yf285yww00.2.$matrixsplit.j.1"><em data-reactid=".1yf285yww00.2.$matrixsplit.j.1.0">Q</em></strong><span data-reactid=".1yf285yww00.2.$matrixsplit.j.2"> to the right, with zeroes getting pushed off the right edge and appearing back on the left, and then flip the matrix vertically. Presto, you just &quot;calculated&quot; </span><strong data-reactid=".1yf285yww00.2.$matrixsplit.j.3"><em data-reactid=".1yf285yww00.2.$matrixsplit.j.3.0">Q&#x27;</em></strong><span data-reactid=".1yf285yww00.2.$matrixsplit.j.4">.</span></p><p data-reactid=".1yf285yww00.2.$matrixsplit.k">Implementing curve splitting this way requires less recursion, and is just straight arithmetic with cached values, so can be cheaper on systems were recursion is expensive. If you&#x27;re doing computation with devices that are good at matrix multiplication, chopping up a Bézier curve with this method will be a lot faster than applying de Casteljau.</p></section><table class="relatives after" data-reactid=".1yf285yww00.2.2"><tbody data-reactid=".1yf285yww00.2.2.0"><tr data-reactid=".1yf285yww00.2.2.0.0"><td data-reactid=".1yf285yww00.2.2.0.0.0"><a class="prev" href="splitting" data-reactid=".1yf285yww00.2.2.0.0.0.0">8. Splitting curves</a></td><td class="toc" data-reactid=".1yf285yww00.2.2.0.0.1"><a class="" href="/" data-reactid=".1yf285yww00.2.2.0.0.1.0">ToC</a></td><td data-reactid=".1yf285yww00.2.2.0.0.2"><a class="next" href="reordering" data-reactid=".1yf285yww00.2.2.0.0.2.0">10. Lowering and elevating curve order</a></td></tr></tbody></table></div><footer class="copyright" data-reactid=".1yf285yww00.3"><span data-reactid=".1yf285yww00.3.0">This article is © 2011-2016 to me, Mike &quot;Pomax&quot; Kamermans, but the text, code, and images are </span><a href="https://github.com/Pomax/bezierinfo/blob/gh-pages/LICENSE.md" data-reactid=".1yf285yww00.3.1">almost no rights reserved</a><span data-reactid=".1yf285yww00.3.2">. Go do something cool with it!</span></footer></div>
</body>
</html>