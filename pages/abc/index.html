<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<title>
The projection identity
</title>
<base href='..'>
</head>
<body>
<div data-reactid=".1dqswl51yww" data-react-checksum="160007806"><div class="ribbon" data-reactid=".1dqswl51yww.0"><img src="images/ribbon.png" alt="This page on GitHub" usemap="#githubmap" width="200px" height="149px" data-reactid=".1dqswl51yww.0.0"/><map name="githubmap" data-reactid=".1dqswl51yww.0.1"><area shape="poly" coords="30,0, 200,0, 200,114" href="http://github.com/pomax/BezierInfo-2" alt="This page on GitHub" data-reactid=".1dqswl51yww.0.1.0"/></map></div><header data-reactid=".1dqswl51yww.1"><h1 data-reactid=".1dqswl51yww.1.0">A Primer on Bézier Curves</h1><h2 data-reactid=".1dqswl51yww.1.1">A free, online book for when you really need to know how to do Bézier things.</h2></header><div data-reactid=".1dqswl51yww.2"><table class="relatives before" data-reactid=".1dqswl51yww.2.0"><tbody data-reactid=".1dqswl51yww.2.0.0"><tr data-reactid=".1dqswl51yww.2.0.0.0"><td data-reactid=".1dqswl51yww.2.0.0.0.0"><a class="prev" href="curveintersection" data-reactid=".1dqswl51yww.2.0.0.0.0.0">23. Curve/curve intersection</a></td><td class="toc" data-reactid=".1dqswl51yww.2.0.0.0.1"><a class="" href="/" data-reactid=".1dqswl51yww.2.0.0.0.1.0">ToC</a></td><td data-reactid=".1dqswl51yww.2.0.0.0.2"><a class="next" href="moulding" data-reactid=".1dqswl51yww.2.0.0.0.2.0">25. Manipulating a curve</a></td></tr></tbody></table><section data-reactid=".1dqswl51yww.2.$abc"><h2 data-num="24" data-reactid=".1dqswl51yww.2.$abc.0"><a href="#abc" data-reactid=".1dqswl51yww.2.$abc.0.0">The projection identity</a></h2><p data-reactid=".1dqswl51yww.2.$abc.1">De Casteljau&#x27;s algorithm is the pivotal algorithm when it comes to Bézier curves. You can use it not just to split curves, but also to draw them efficiently (especially for high-order Bézier curves), as well as to come up with curves based on three points and a tangent. Particularly this last thing is really useful because it lets us &quot;mould&quot; a curve, by picking it up at some point, and dragging that point around to change the curve&#x27;s shape.</p><p data-reactid=".1dqswl51yww.2.$abc.2">How does that work? Succinctly: we run de Casteljau&#x27;s algorithm in reverse!</p><p data-reactid=".1dqswl51yww.2.$abc.3"><span data-reactid=".1dqswl51yww.2.$abc.3.0">In order to run de Casteljau&#x27;s algorithm in reverse, we need a few basic things: a start and end point, a point on the curve that want to be moving around, which has an associated </span><i data-reactid=".1dqswl51yww.2.$abc.3.1">t</i><span data-reactid=".1dqswl51yww.2.$abc.3.2"> value, and a point we&#x27;ve not explicitly talked about before, and as far as I know has no explicit name, but lives one iteration higher in the de Casteljau process then our on-curve point does. I like to call it &quot;A&quot; for reasons that will become obvious.</span></p><p data-reactid=".1dqswl51yww.2.$abc.4">So let&#x27;s use graphics instead of text to see where this &quot;A&quot; is, because text only gets us so far: in the following graphic, click anywhere on the curves to see the identity information that we&#x27;ll be using to run de Casteljau in reverse (you can manipulate the curve even after picking a point. Note the &quot;ratio&quot; value when you do so: does it change?):</p><div class="figure" data-reactid=".1dqswl51yww.2.$abc.5"><figure class="inline" data-reactid=".1dqswl51yww.2.$abc.5.0"><canvas tabindex="0" data-reactid=".1dqswl51yww.2.$abc.5.0.0"></canvas><figcaption data-reactid=".1dqswl51yww.2.$abc.5.0.1"><span data-reactid=".1dqswl51yww.2.$abc.5.0.1.0">Projections in a quadratic Bézier curve</span><span data-reactid=".1dqswl51yww.2.$abc.5.0.1.1"> </span></figcaption></figure><figure class="inline" data-reactid=".1dqswl51yww.2.$abc.5.1"><canvas tabindex="0" data-reactid=".1dqswl51yww.2.$abc.5.1.0"></canvas><figcaption data-reactid=".1dqswl51yww.2.$abc.5.1.1"><span data-reactid=".1dqswl51yww.2.$abc.5.1.1.0">Projections in a cubic Bézier curve</span><span data-reactid=".1dqswl51yww.2.$abc.5.1.1.1"> </span></figcaption></figure></div><p data-reactid=".1dqswl51yww.2.$abc.6">Clicking anywhere on the curves shows us three things:</p><ol data-reactid=".1dqswl51yww.2.$abc.7"><li data-reactid=".1dqswl51yww.2.$abc.7.0"><span data-reactid=".1dqswl51yww.2.$abc.7.0.0">our on-curve point; let&#x27;s call that </span><b data-reactid=".1dqswl51yww.2.$abc.7.0.1">B</b><span data-reactid=".1dqswl51yww.2.$abc.7.0.2">,</span></li><li data-reactid=".1dqswl51yww.2.$abc.7.1"><span data-reactid=".1dqswl51yww.2.$abc.7.1.0">a point at the tip of B&#x27;s &quot;hat&quot;, on de Casteljau step up; let&#x27;s call that </span><b data-reactid=".1dqswl51yww.2.$abc.7.1.1">A</b><span data-reactid=".1dqswl51yww.2.$abc.7.1.2">, and</span></li><li data-reactid=".1dqswl51yww.2.$abc.7.2"><span data-reactid=".1dqswl51yww.2.$abc.7.2.0">a point that we get by projecting B onto the start--end baseline; let&#x27;s call that </span><b data-reactid=".1dqswl51yww.2.$abc.7.2.1">C</b><span data-reactid=".1dqswl51yww.2.$abc.7.2.2">.</span></li></ol><p data-reactid=".1dqswl51yww.2.$abc.8"><span data-reactid=".1dqswl51yww.2.$abc.8.0">These three values ABC hide an important identity formula for quadratic and cubic Bézier curves: for any point on the curve with some </span><i data-reactid=".1dqswl51yww.2.$abc.8.1">t</i><span data-reactid=".1dqswl51yww.2.$abc.8.2"> value, the ratio distance of C along baseline is fixed: if some </span><i data-reactid=".1dqswl51yww.2.$abc.8.3">t</i><span data-reactid=".1dqswl51yww.2.$abc.8.4"> value sets up a C that is 20% away from the start and 80% away from the end, then it doesn&#x27;t matter where the start, end, or control points are: for that </span><i data-reactid=".1dqswl51yww.2.$abc.8.5">t</i><span data-reactid=".1dqswl51yww.2.$abc.8.6"> value, C will </span><em data-reactid=".1dqswl51yww.2.$abc.8.7">always</em><span data-reactid=".1dqswl51yww.2.$abc.8.8"> lie at 20% from the start and 80% from the end point. Go ahead, pick an on-curve point in either graphic and then move all the other points around: if you only move the control points, start and end won&#x27;t move, and so neither will C, and if you move either start or end point, C will move but its relative position will not change. The following function stays true:</span></p><p data-reactid=".1dqswl51yww.2.$abc.9"><img class="LaTeX SVG" src="images/latex/f48f095d9c37c079ff6a5f71b3047397aa7dfc6b.svg" style="width:13.19985rem;height:1.125rem;" data-reactid=".1dqswl51yww.2.$abc.9.0"/></p><p data-reactid=".1dqswl51yww.2.$abc.a">So that just leaves finding A.</p><div class="note" data-reactid=".1dqswl51yww.2.$abc.b"><p data-reactid=".1dqswl51yww.2.$abc.b.0"><span data-reactid=".1dqswl51yww.2.$abc.b.0.0">While that relation is fixed, the function </span><i data-reactid=".1dqswl51yww.2.$abc.b.0.1">u(t)</i><span data-reactid=".1dqswl51yww.2.$abc.b.0.2"> differs depending on whether we&#x27;re working with quadratic or cubic curves:</span></p><p data-reactid=".1dqswl51yww.2.$abc.b.1"><img class="LaTeX SVG" src="images/latex/b2db06c0139cd2c346ce764393f5c7252a16b5f2.svg" style="width:12.524849999999999rem;height:5.70015rem;" data-reactid=".1dqswl51yww.2.$abc.b.1.0"/></p><p data-reactid=".1dqswl51yww.2.$abc.b.2"><span data-reactid=".1dqswl51yww.2.$abc.b.2.0">So, if we know the start and end coordinates, and we know the </span><i data-reactid=".1dqswl51yww.2.$abc.b.2.1">t</i><span data-reactid=".1dqswl51yww.2.$abc.b.2.2"> value, we know C:</span></p><div class="figure" data-reactid=".1dqswl51yww.2.$abc.b.3"><figure class="inline" data-reactid=".1dqswl51yww.2.$abc.b.3.0"><canvas tabindex="0" data-reactid=".1dqswl51yww.2.$abc.b.3.0.0"></canvas><figcaption data-reactid=".1dqswl51yww.2.$abc.b.3.0.1"><span data-reactid=".1dqswl51yww.2.$abc.b.3.0.1.0">Quadratic value of C for t</span><span data-reactid=".1dqswl51yww.2.$abc.b.3.0.1.1"> </span></figcaption></figure><figure class="inline" data-reactid=".1dqswl51yww.2.$abc.b.3.1"><canvas tabindex="0" data-reactid=".1dqswl51yww.2.$abc.b.3.1.0"></canvas><figcaption data-reactid=".1dqswl51yww.2.$abc.b.3.1.1"><span data-reactid=".1dqswl51yww.2.$abc.b.3.1.1.0">Cubic value of C for t</span><span data-reactid=".1dqswl51yww.2.$abc.b.3.1.1.1"> </span></figcaption></figure></div><p data-reactid=".1dqswl51yww.2.$abc.b.4"><span data-reactid=".1dqswl51yww.2.$abc.b.4.0">Mouse-over the graphs to see the expression for C, given the </span><i data-reactid=".1dqswl51yww.2.$abc.b.4.1">t</i><span data-reactid=".1dqswl51yww.2.$abc.b.4.2"> value at the mouse pointer.</span></p></div><p data-reactid=".1dqswl51yww.2.$abc.c"><span data-reactid=".1dqswl51yww.2.$abc.c.0">There&#x27;s also another important bit of information that is inherent to the ABC values: while the distances between A and B, and B and C, are dynamic (based on where we put B), the </span><em data-reactid=".1dqswl51yww.2.$abc.c.1">ratio</em><span data-reactid=".1dqswl51yww.2.$abc.c.2"> between the two distances is stable: given some </span><i data-reactid=".1dqswl51yww.2.$abc.c.3">t</i><span data-reactid=".1dqswl51yww.2.$abc.c.4"> value, the following always holds:</span></p><p data-reactid=".1dqswl51yww.2.$abc.d"><img class="LaTeX SVG" src="images/latex/6cb3e94fe9164128a25570a32abed15baa726f17.svg" style="width:17.92485rem;height:2.7rem;" data-reactid=".1dqswl51yww.2.$abc.d.0"/></p><p data-reactid=".1dqswl51yww.2.$abc.e"><span data-reactid=".1dqswl51yww.2.$abc.e.0">This leads to a pretty powerful bit of knowledge: merely by knowing the </span><i data-reactid=".1dqswl51yww.2.$abc.e.1">t</i><span data-reactid=".1dqswl51yww.2.$abc.e.2"> value of some on curve point, we know where C has to be (as per the above note), and because we know B and C, and thus have the distance between them, we know where A has to be:</span></p><p data-reactid=".1dqswl51yww.2.$abc.f"><img class="LaTeX SVG" src="images/latex/1dffb79b42799c95c899e689b074361f662ec807.svg" style="width:15.525rem;height:2.55015rem;" data-reactid=".1dqswl51yww.2.$abc.f.0"/></p><p data-reactid=".1dqswl51yww.2.$abc.g">And that&#x27;s it, all values found.</p><div class="note" data-reactid=".1dqswl51yww.2.$abc.h"><p data-reactid=".1dqswl51yww.2.$abc.h.0"><span data-reactid=".1dqswl51yww.2.$abc.h.0.0">Much like the </span><i data-reactid=".1dqswl51yww.2.$abc.h.0.1">u(t)</i><span data-reactid=".1dqswl51yww.2.$abc.h.0.2"> function in the above note, the </span><i data-reactid=".1dqswl51yww.2.$abc.h.0.3">ratio(t)</i><span data-reactid=".1dqswl51yww.2.$abc.h.0.4"> function depends on whether we&#x27;re looking at quadratic or cubic curves. Their form is intrinsically related to the </span><i data-reactid=".1dqswl51yww.2.$abc.h.0.5">u(t)</i><span data-reactid=".1dqswl51yww.2.$abc.h.0.6"> function in that they both come rolling out of the same function evalution, explained over on </span><a href="http://mathoverflow.net/questions/122257/finding-the-formula-for-Bézier-curve-ratios-hull-point-point-baseline" data-reactid=".1dqswl51yww.2.$abc.h.0.7">MathOverflow</a><span data-reactid=".1dqswl51yww.2.$abc.h.0.8"> by Boris Zbarsky and myself. The ratio functions are the &quot;s(t)&quot; functions from the answers there, while the &quot;u(t)&quot; functions have the same name both here and on MathOverflow.</span></p><p data-reactid=".1dqswl51yww.2.$abc.h.1"><img class="LaTeX SVG" src="images/latex/51ecfbffec979f90ab93a54a5de8cbeb83e150ad.svg" style="width:14.475150000000001rem;height:2.7rem;" data-reactid=".1dqswl51yww.2.$abc.h.1.0"/></p><p data-reactid=".1dqswl51yww.2.$abc.h.2"><img class="LaTeX SVG" src="images/latex/5f2bb71795c615637d632da70b722938cb103b03.svg" style="width:15.075000000000001rem;height:2.77515rem;" data-reactid=".1dqswl51yww.2.$abc.h.2.0"/></p><p data-reactid=".1dqswl51yww.2.$abc.h.3"><span data-reactid=".1dqswl51yww.2.$abc.h.3.0">Unfortunately, this trick only works for quadratic and cubic curves. Once we hit higher order curves, things become a lot less predictable; the &quot;fixed point </span><i data-reactid=".1dqswl51yww.2.$abc.h.3.1">C</i><span data-reactid=".1dqswl51yww.2.$abc.h.3.2">&quot; is no longer fixed, moving around as we move the control points, and projections of </span><i data-reactid=".1dqswl51yww.2.$abc.h.3.3">B</i><span data-reactid=".1dqswl51yww.2.$abc.h.3.4"> onto the line between start and end may actually lie on that line before the start, or after the end, and there are no simple ratios that we can exploit.</span></p></div><p data-reactid=".1dqswl51yww.2.$abc.i"><span data-reactid=".1dqswl51yww.2.$abc.i.0">So: if we know B and its corresponding </span><i data-reactid=".1dqswl51yww.2.$abc.i.1">t</i><span data-reactid=".1dqswl51yww.2.$abc.i.2"> value, then we know all the ABC values, which —together with a start and end coordinate— gives us the necessary information to reconstruct a curve&#x27;s &quot;de Casteljau skeleton&quot;, which means that two points and a value between 0 and 1, we can come up with a curve. And that opens up possibilities: curve manipulation by dragging an on-curve point, curve fitting of &quot;a bunch of coordinates&quot;, these are useful things, and we&#x27;ll look at both in the next sections.</span></p></section><table class="relatives after" data-reactid=".1dqswl51yww.2.2"><tbody data-reactid=".1dqswl51yww.2.2.0"><tr data-reactid=".1dqswl51yww.2.2.0.0"><td data-reactid=".1dqswl51yww.2.2.0.0.0"><a class="prev" href="curveintersection" data-reactid=".1dqswl51yww.2.2.0.0.0.0">23. Curve/curve intersection</a></td><td class="toc" data-reactid=".1dqswl51yww.2.2.0.0.1"><a class="" href="/" data-reactid=".1dqswl51yww.2.2.0.0.1.0">ToC</a></td><td data-reactid=".1dqswl51yww.2.2.0.0.2"><a class="next" href="moulding" data-reactid=".1dqswl51yww.2.2.0.0.2.0">25. Manipulating a curve</a></td></tr></tbody></table></div><footer class="copyright" data-reactid=".1dqswl51yww.3"><span data-reactid=".1dqswl51yww.3.0">This article is © 2011-2016 to me, Mike &quot;Pomax&quot; Kamermans, but the text, code, and images are </span><a href="https://github.com/Pomax/bezierinfo/blob/gh-pages/LICENSE.md" data-reactid=".1dqswl51yww.3.1">almost no rights reserved</a><span data-reactid=".1dqswl51yww.3.2">. Go do something cool with it!</span></footer></div>
</body>
</html>